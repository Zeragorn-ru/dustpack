[General]

name=DustPack
AutomaticJava=true

JoinServerOnLaunchAddress=aoba.lol

PreLaunchCommand=powershell -NoProfile -ExecutionPolicy Bypass -Command "$base=(Resolve-Path '..').Path; $api='https://api.github.com/repos/Zeragorn-ru/dustpack/releases/latest'; $hashFile=Join-Path $base 'github-digest.txt'; $zip=Join-Path $base 'temp.zip'; try { $r=Invoke-RestMethod -Uri $api -Headers @{ 'User-Agent'='PS' } -TimeoutSec 30; $asset=$r.assets | Where-Object name -eq 'modpack.mrpack'; if(!$asset -or !$asset.digest){ exit }; $newDigest=$asset.digest; if(Test-Path $hashFile){ if((Get-Content $hashFile -Raw) -eq $newDigest){ exit } } Invoke-WebRequest $asset.browser_download_url -OutFile $zip -UseBasicParsing; Expand-Archive $zip -DestinationPath $base -Force; $newDigest | Out-File $hashFile -NoNewline -Force; Remove-Item $zip -Force } catch { }"
